<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Aero ICQ Lite</title>
    <style>
        /* –°—Ç–∏–ª—å –≤ –¥—É—Ö–µ —Å—Ç–∞—Ä–æ–π Windows –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ */
        body { background: #008080; font-family: sans-serif; font-size: 14px; color: #000; margin: 0; }
        .win { background: #c0c0c0; border: 2px solid; border-color: #fff #808080 #808080 #fff; width: 100%; max-width: 300px; margin: auto; }
        .title { background: #000080; color: #fff; padding: 3px; font-weight: bold; }
        #box { background: #fff; height: 180px; overflow: auto; border: 2px inset #fff; margin: 5px; padding: 3px; }
        .msg { border-bottom: 1px dotted #808080; margin-bottom: 3px; }
        .u { color: #ff0000; font-weight: bold; }
        .input-area { padding: 5px; }
        input { width: 100px; }
    </style>
</head>
<body>

<div class="win">
    <div class="title">üåº AeroChat ICQ (Opera Edition)</div>
    <div id="box">–ù–∞–∂–º–∏ "–û–±–Ω–æ–≤–∏—Ç—å"...</div>
    
    <div class="input-area">
        <input type="text" id="user" value="User" style="width:50px">
        <input type="text" id="msg" placeholder="–¢–µ–∫—Å—Ç...">
        <br>
        <button onclick="send()">[ –û–¢–ü–†–ê–í–ò–¢–¨ ]</button>
        <button onclick="load()">[ –û–ë–ù–û–í–ò–¢–¨ ]</button>
    </div>
</div>

<script>
    // –ü—Ä—è–º–æ–π –ø—É—Ç—å –∫ —Ç–≤–æ–µ–π –±–∞–∑–µ (—á–µ—Ä–µ–∑ .json)
    var dbUrl = "https://ple7-edit-v1-default-rtdb.europe-west1.firebasedatabase.app/messages.json";

    function load() {
        var xhr = new XMLHttpRequest();
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ, —á—Ç–æ–±—ã Opera Mini –Ω–µ –±—Ä–∞–ª–∞ —Å—Ç–∞—Ä—É—é –∫–æ–ø–∏—é –∏–∑ –∫–µ—à–∞
        xhr.open("GET", dbUrl + "?nocache=" + Math.random(), true);
        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4) {
                if (xhr.status == 200) {
                    var data = JSON.parse(xhr.responseText);
                    var html = "";
                    for (var id in data) {
                        html += '<div class="msg"><span class="u">' + data[id].u + ':</span> ' + data[id].m + '</div>';
                    }
                    document.getElementById('box').innerHTML = html;
                } else {
                    document.getElementById('box').innerHTML = "–û—à–∏–±–∫–∞ —Å–µ—Ç–∏: " + xhr.status;
                }
            }
        };
        xhr.send();
    }

    function send() {
        var u = document.getElementById('user').value;
        var m = document.getElementById('msg').value;
        if (!m) return;

        var xhr = new XMLHttpRequest();
        xhr.open("POST", dbUrl, true);
        xhr.onreadystatechange = function() {
            if (xhr.readyState == 4) {
                document.getElementById('msg').value = "";
                load(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
            }
        };
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
        xhr.send(JSON.stringify({ u: u, m: m }));
    }

    // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ä–∞–∑—É
    load();
</script>

</body>
</html>
